# SPX Command Center 90-Day Deterministic Plan

Plan window:
- Start: 2026-03-02 (Monday)
- End: 2026-05-29 (Friday)
- Buffer: 2026-05-30

Reference timezone: America/Chicago

## Operating Rules
1. Freeze contracts first, then refactor behind flags.
2. All P0 changes ship behind backend+frontend flags when risk > Low.
3. Two-week sprint cadence with Friday release train.
4. Exit criteria is objective (tests, telemetry, runbook, staging validation).

## Workstreams (Epics)
- EPIC-A: Execution Safety v2 (Tradier bracket/OCO + fills + restart)
- EPIC-B: Data Quality Contract (snapshot quality and UI truth)
- EPIC-C: Setup Pipeline Correctness (symbol gating + TTL/regime)
- EPIC-D: Database/RLS Hardening and Schema Truth
- EPIC-E: Optimizer Enforcement and History UX
- EPIC-F: UX Persistence, Accessibility, and Render Budget
- EPIC-G: Test Harness, CI Gates, and Operational Runbooks

## Sprint 1 (2026-03-02 to 2026-03-13)
Theme: Stabilize, secure, and expose truth

Target outcomes:
- SPX-only tick transition gating
- VWAP setup types present in DB constraints
- Execution-table RLS hardened
- PDT schema mismatch fixed with safe failure mode
- Tradier readiness check added

Exit criteria:
- Schema contract test in CI
- SetupType alignment test present (initial subset allowed)
- Staging smoke script validates transitions + RLS + snapshot load

## Sprint 2 (2026-03-16 to 2026-03-27)
Theme: Execution truth layer

Target outcomes:
- Restart-safe execution state machine v2
- `orderLifecycleManager` wired for fill polling
- Real option fill price/qty persisted from Tradier
- Execution telemetry for ack/fill/reject latency

Exit criteria:
- Partial-fill integration test
- Restart recovery test for ENTRY_WORKING state

## Sprint 3 (2026-03-30 to 2026-04-10)
Theme: Protective behavior and emergency controls

Target outcomes:
- True bracket/OCO flow (protective stop immediately after fill)
- Kill switch upgraded to cancel + flatten + verify
- Out-of-order fill reconciliation safety

Exit criteria:
- Broker lifecycle test suite (mock Tradier)
- Staging kill-switch end-to-end validation

## Sprint 4 (2026-04-13 to 2026-04-24)
Theme: Data quality contract and scale hardening

Target outcomes:
- Snapshot includes stage-level `dataQuality`
- Redis snapshot cache + advisory lock
- Stream reconnect jitter (backend/frontend)
- Snapshot coherence timestamp

Exit criteria:
- Timeout chaos test exposes degraded state in UI
- Load test proves no cross-instance stampede

## Sprint 5 (2026-04-27 to 2026-05-08)
Theme: Optimizer enforcement and confluence reliability

Target outcomes:
- Execution path enforces optimizer gate
- Multi-day 1h confluence history and reliability
- NaN confidence hardening
- Tier threshold policy alignment
- Read-only optimizer history panel

Exit criteria:
- Blocked gate prevents order placement in tests
- Confluence reliability tests pass with sufficient history

## Sprint 6 (2026-05-11 to 2026-05-22)
Theme: UX persistence and accessibility

Target outcomes:
- Panel layout persistence
- Classic/spatial state preservation
- Command palette accessibility upgrades
- Unused hook cleanup/labeling
- Render budget instrumentation

Exit criteria:
- View toggles preserve state and selection
- Keyboard a11y checks pass

## Hardening and Release Week (2026-05-25 to 2026-05-29)
Theme: Runbooks, final verification, and controlled rollout

Target outcomes:
- Operations runbook completed
- Final load/execution/migration safety validation
- Staged rollout plan for `executionV2`

Exit criteria:
- Production readiness checklist green
- Monitoring dashboards active for execution/snapshot/tick health
- Rollback procedure documented and tested

## First 72 Hours
2026-03-02:
- Land audit docs, roadmap docs, seam/risk tracking
- Add issue and PR templates
- Open epics in external tracker

2026-03-03:
- Create P0/P1 tickets for Sprint 1 and Sprint 2
- Add CI stubs: schema contract + SetupType alignment

2026-03-04:
- Start implementation order:
  1) Tick symbol gate
  2) VWAP constraint migration
  3) RLS lockdown
  4) PDT schema + safe failure mode

## Flag Plan
- `executionV2`
- `snapshotQualityV1`
- `optimizerGateEnforcedV1`
- `setupTickSymbolGateV1`
