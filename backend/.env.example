# =============================================================================
# TITM AI Coach - Backend Environment Variables
# =============================================================================
# Copy this file to .env and fill in your values:
#   cp .env.example .env
# =============================================================================

# --- REQUIRED ---

# Supabase (https://supabase.com/dashboard → Project Settings → API)
SUPABASE_URL=https://your-project-ref.supabase.co
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# OpenAI (https://platform.openai.com/api-keys)
OPENAI_API_KEY=sk-proj-...

# Massive.com Market Data (https://massive.com/dashboard)
MASSIVE_API_KEY=your-massive-api-key
ALPHA_VANTAGE_API_KEY=your-alpha-vantage-api-key
# ALPHA_VANTAGE_BASE_URL=https://www.alphavantage.co/query

# FMP (Financial Modeling Prep) — free tier earnings calendar supplement
# Sign up: https://site.financialmodelingprep.com/register
# FMP_API_KEY=your-fmp-api-key
# FMP_ENABLED=false

# FRED (Federal Reserve Economic Data) — free economic calendar + macro series
# Sign up: https://fred.stlouisfed.org/docs/api/api_key.html
# FRED_API_KEY=your-fred-api-key
# FRED_ENABLED=false

# Massive tick stream (optional; enables tick-level ingest/fanout)
# MASSIVE_TICK_WS_ENABLED=false
# MASSIVE_TICK_WS_URL=wss://socket.massive.com/indices
# MASSIVE_TICK_SYMBOLS=SPX,SPY
# MASSIVE_TICK_EVENT_PREFIX=V.
# MASSIVE_TICK_RECONNECT_BASE_MS=1000
# MASSIVE_TICK_RECONNECT_MAX_MS=30000
# MASSIVE_TICK_FANOUT_THROTTLE_MS=150
# MASSIVE_MICROBAR_FANOUT_THROTTLE_MS=250
# MASSIVE_TICK_STALE_MS=5000
# ENABLE_L2_MICROSTRUCTURE=true

# SPX setup lifecycle controls (production-safe defaults)
# SPX_SETUP_LIFECYCLE_ENABLED=true
# SPX_SETUP_TRANSITION_TELEMETRY_ENABLED=true
# SPX_SETUP_DEMOTION_STREAK=2
# SPX_SETUP_INVALIDATION_STREAK=3
# SPX_SETUP_FLOW_DIVERGENCE_THRESHOLD=38
# SPX_SETUP_REGIME_CONFLICT_CONFIDENCE_THRESHOLD=68
# SPX_SETUP_STOP_CONFIRMATION_TICKS=2
# SPX_SETUP_TTL_FORMING_MS=1200000
# SPX_SETUP_TTL_READY_MS=1500000
# SPX_SETUP_TTL_TRIGGERED_MS=5400000
# SPX_SETUP_EV_TIERING_ENABLED=true
# SPX_SETUP_SNIPER_PRIMARY_SCORE=78
# SPX_SETUP_SNIPER_SECONDARY_SCORE=72
# SPX_SETUP_SNIPER_PRIMARY_PWIN=0.58
# SPX_SETUP_SNIPER_SECONDARY_PWIN=0.54
# SPX_SETUP_SNIPER_PRIMARY_EV_R=0.35
# SPX_SETUP_SNIPER_SECONDARY_EV_R=0.20
# SPX_SETUP_MACRO_KILLSWITCH_ENABLED=true
# SPX_SETUP_MACRO_MIN_ALIGNMENT_SCORE=34
# Suggested optimizer sweep anchors for macro floor: 30,34,38
# SPX_SETUP_DIVERSIFICATION_ENABLED=true
# SPX_SETUP_ALLOW_RECOVERY_COMBOS=true
# SPX_SETUP_FADE_READY_MAX_SHARE=0.50
# SPX_SETUP_MIN_ALTERNATIVE_READY_SETUPS=1
# SPX_SETUP_MIN_TREND_READY_SETUPS=1
# SPX_SETUP_TREND_PROMOTION_MIN_SCORE=66
# SPX_SETUP_TREND_PROMOTION_MIN_PWIN=0.57
# SPX_SETUP_TREND_PROMOTION_MIN_EV_R=0.22
# SPX_SETUP_TREND_PROMOTION_MIN_MACRO_SCORE=34
# SPX_SETUP_TREND_PROMOTION_MIN_MICRO_SCORE=56
# SPX_SETUP_TREND_PROMOTION_REQUIRE_MICRO_ALIGNMENT=true
# SPX_SETUP_MICROSTRUCTURE_ENABLED=true
# SPX_SETUP_MICROSTRUCTURE_LOOKBACK_TICKS=180
# SPX_SETUP_MICROSTRUCTURE_MIN_TICKS=24
# SPX_SETUP_MICROSTRUCTURE_MIN_DIRECTIONAL_VOLUME=120
# SPX_SETUP_MICROSTRUCTURE_MIN_QUOTE_COVERAGE_PCT=0.35
# SPX_SETUP_MICROSTRUCTURE_MIN_AGGRESSOR_SKEW=0.10
# SPX_SETUP_MICROSTRUCTURE_MIN_IMBALANCE=0.06
# SPX_SETUP_MICROSTRUCTURE_MAX_SPREAD_BPS=30
# SPX_SETUP_MICROSTRUCTURE_REQUIRE_TREND_ALIGNMENT=true
# SPX_SETUP_MICROSTRUCTURE_FAIL_CLOSED_WHEN_UNAVAILABLE=false
# Suggested optimizer sweep anchors:
# - SPX_SETUP_MICROSTRUCTURE_MIN_AGGRESSOR_SKEW: 0.07,0.10,0.13
# - SPX_SETUP_MICROSTRUCTURE_MIN_IMBALANCE: 0.04,0.06,0.08
# - SPX_SETUP_MICROSTRUCTURE_MIN_QUOTE_COVERAGE_PCT: 0.30,0.40,0.50

# --- OPTIONAL (defaults shown) ---

# Redis cache (falls back to localhost if not set)
# REDIS_URL=redis://localhost:6379

# Server port
# PORT=3001

# Sentry (error monitoring — leave blank to disable)
# SENTRY_DSN=https://examplePublicKey@o0.ingest.sentry.io/0

# Worker health alerting (Discord + optional Sentry incident reporting)
# WORKER_ALERTS_ENABLED=false
# WORKER_ALERTS_DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/...
# WORKER_ALERTS_POLL_INTERVAL_MS=60000
# WORKER_ALERTS_STALE_THRESHOLD_MS=1200000
# WORKER_ALERTS_STARTUP_GRACE_MS=300000
# WORKER_ALERTS_COOLDOWN_MS=900000
# WORKER_ALERTS_SENTRY_ENABLED=false

# E2E auth bypass (non-production test runs only)
# E2E_BYPASS_AUTH=false
# E2E_BYPASS_ALLOW_IN_PRODUCTION=false
# E2E_BYPASS_TOKEN_PREFIX=e2e:
# E2E_BYPASS_SHARED_SECRET=replace-with-long-random-secret

# Web push notifications (optional, required to deliver browser push payloads)
# VAPID_PUBLIC_KEY=your-base64url-vapid-public-key
# VAPID_PRIVATE_KEY=your-base64url-vapid-private-key
# VAPID_SUBJECT=mailto:support@tradeitm.com
