# =============================================================================
# TITM AI Coach - Backend Environment Variables
# =============================================================================
# Copy this file to .env and fill in your values:
#   cp .env.example .env
# =============================================================================

# --- REQUIRED ---

# Supabase (https://supabase.com/dashboard → Project Settings → API)
SUPABASE_URL=https://your-project-ref.supabase.co
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# OpenAI (https://platform.openai.com/api-keys)
OPENAI_API_KEY=sk-proj-...

# Massive.com Market Data (https://massive.com/dashboard)
MASSIVE_API_KEY=your-massive-api-key
ALPHA_VANTAGE_API_KEY=your-alpha-vantage-api-key
# ALPHA_VANTAGE_BASE_URL=https://www.alphavantage.co/query

# FMP (Financial Modeling Prep) — free tier earnings calendar supplement
# Sign up: https://site.financialmodelingprep.com/register
# FMP_API_KEY=your-fmp-api-key
# FMP_ENABLED=false

# FRED (Federal Reserve Economic Data) — free economic calendar + macro series
# Sign up: https://fred.stlouisfed.org/docs/api/api_key.html
# FRED_API_KEY=your-fred-api-key
# FRED_ENABLED=false

# Massive tick stream (optional; enables tick-level ingest/fanout)
# MASSIVE_TICK_WS_ENABLED=false
# MASSIVE_TICK_LOCK_ENABLED=false
# Enable Redis advisory lock for single-upstream enforcement when horizontally scaled.
# MASSIVE_TICK_WS_URL=wss://socket.massive.com/indices
# MASSIVE_TICK_SYMBOLS=SPX,SPY,VIX,VIX9D,VVIX,SKEW
# MASSIVE_TICK_EVENT_PREFIX=V.
# MASSIVE_TICK_RECONNECT_BASE_MS=1000
# MASSIVE_TICK_RECONNECT_MAX_MS=30000
# MASSIVE_TICK_FANOUT_THROTTLE_MS=150
# MASSIVE_MICROBAR_FANOUT_THROTTLE_MS=250
# MASSIVE_TICK_STALE_MS=5000

# SPX setup lifecycle controls (production-safe defaults)
# SPX_SETUP_LIFECYCLE_ENABLED=true
# SPX_SETUP_TRANSITION_TELEMETRY_ENABLED=true
# SPX_SETUP_DEMOTION_STREAK=2
# SPX_SETUP_INVALIDATION_STREAK=3
# SPX_SETUP_FLOW_DIVERGENCE_THRESHOLD=38
# SPX_SETUP_REGIME_CONFLICT_CONFIDENCE_THRESHOLD=68
# SPX_SETUP_STOP_CONFIRMATION_TICKS=2
# SPX_SETUP_TTL_FORMING_MS=1200000
# SPX_SETUP_TTL_READY_MS=1500000
# SPX_SETUP_TTL_TRIGGERED_MS=5400000
# SPX_SETUP_EV_TIERING_ENABLED=true
# SPX_SETUP_SNIPER_PRIMARY_SCORE=78
# SPX_SETUP_SNIPER_SECONDARY_SCORE=72
# SPX_SETUP_SNIPER_PRIMARY_PWIN=0.58
# SPX_SETUP_SNIPER_SECONDARY_PWIN=0.54
# SPX_SETUP_SNIPER_PRIMARY_EV_R=0.35
# SPX_SETUP_SNIPER_SECONDARY_EV_R=0.20
# SPX_ENVIRONMENT_GATE_ENABLED=false
# SPX_ENVIRONMENT_LIVE_SESSION_ENABLED=false
# SPX_EVENT_RISK_GATE_ENABLED=false
# SPX_NEWS_SENTIMENT_ENABLED=false
# SPX_MEMORY_ENGINE_ENABLED=false
# SPX_MULTI_TF_CONFLUENCE_ENABLED=false
# SPX_WEIGHTED_CONFLUENCE_ENABLED=false
# SPX_ADAPTIVE_EV_ENABLED=false
# SPX_EV_SLIPPAGE_R=0.05

# Tradier broker integration (sandbox-first defaults)
# TRADIER_BASE_URL=https://sandbox.tradier.com/v1
# TRADIER_SANDBOX=true
# TRADIER_CREDENTIAL_ENVELOPE_KEY_B64=base64-32-byte-key
# TRADIER_ALLOW_PLAINTEXT_CREDENTIALS=false
# TRADIER_PORTFOLIO_SYNC_ENABLED=false
# TRADIER_PORTFOLIO_SYNC_PRODUCTION_ENABLED=false
# TRADIER_PORTFOLIO_SYNC_INTERVAL_MS=60000
# TRADIER_PORTFOLIO_SYNC_SHIFT_THRESHOLD_PCT=1
# TRADIER_PDT_DTBP_ALERT_THRESHOLD=25000
# TRADIER_PDT_DTBP_ALERT_COOLDOWN_MS=1800000
# TRADIER_EXECUTION_ENABLED=false
# TRADIER_EXECUTION_PRODUCTION_ENABLED=false
# TRADIER_EXECUTION_SANDBOX=true
# TRADIER_EXECUTION_REQUIRE_AUTO_EXECUTE_METADATA=true
# TRADIER_EXECUTION_ALLOWED_USER_IDS=
# TRADIER_EXECUTION_ENTRY_LIMIT_OFFSET=0.2
# TRADIER_EXECUTION_T1_SCALE_PCT=0.65
# TRADIER_EXECUTION_RISK_PCT=0.02
# TRADIER_EXECUTION_DTBP_UTILIZATION=0.90
# TRADIER_POSITION_RECONCILIATION_ENABLED=false
# TRADIER_POSITION_RECONCILIATION_PRODUCTION_ENABLED=false
# TRADIER_FORCE_FLATTEN_ENABLED=false
# TRADIER_FORCE_FLATTEN_PRODUCTION_ENABLED=false
# TRADIER_FORCE_FLATTEN_MINUTES_BEFORE_CLOSE=5
# Optional readiness probe credentials (used by /health/ready and /health/detailed)
# TRADIER_HEALTHCHECK_ACCOUNT_ID=replace-with-probe-account-id
# TRADIER_HEALTHCHECK_ACCESS_TOKEN=replace-with-probe-access-token
# TRADIER_HEALTHCHECK_SANDBOX=true

# --- OPTIONAL (defaults shown) ---

# Redis cache (falls back to localhost if not set)
# REDIS_URL=redis://localhost:6379

# Server port
# PORT=3001

# Maximum concurrent member WebSocket clients
# WS_MAX_CLIENTS=200

# Sentry (error monitoring — leave blank to disable)
# SENTRY_DSN=https://examplePublicKey@o0.ingest.sentry.io/0

# Worker health alerting (Discord + optional Sentry incident reporting)
# WORKER_ALERTS_ENABLED=false
# WORKER_ALERTS_DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/...
# WORKER_ALERTS_POLL_INTERVAL_MS=60000
# WORKER_ALERTS_STALE_THRESHOLD_MS=1200000
# WORKER_ALERTS_STARTUP_GRACE_MS=300000
# WORKER_ALERTS_COOLDOWN_MS=900000
# WORKER_ALERTS_SENTRY_ENABLED=false

# E2E auth bypass (non-production test runs only)
# E2E_BYPASS_AUTH=false
# E2E_BYPASS_ALLOW_IN_PRODUCTION=false
# E2E_BYPASS_TOKEN_PREFIX=e2e:
# E2E_BYPASS_SHARED_SECRET=replace-with-long-random-secret

# Web push notifications (optional, required to deliver browser push payloads)
# VAPID_PUBLIC_KEY=your-base64url-vapid-public-key
# VAPID_PRIVATE_KEY=your-base64url-vapid-private-key
# VAPID_SUBJECT=mailto:support@tradeitm.com
